<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../fs-client/fs-client.html">
<link rel="import" href="../fs-behavior/fs-behavior.html">

<dom-module id="fs-signin">
  <link rel="import" type="css" href="fs-signin.css">
  <template>
    <fs-client id="client" name="{{clientName}}" on-authenticated-changed="_authenticatedChanged"></fs-client>
    <template is="dom-if" if="{{_isUnauthenticated(signedIn)}}">
      <button id="signin" class="fs-button fs-button--recommended" on-click="_signIn">Sign In</button>
    </template>
    <template is="dom-if" if="{{_isAuthenticated(signedIn)}}">
      <button id="signout" class="fs-button fs-button--recommended" on-click="_signOut">Sign Out</button>
    </template>
  </template>
</dom-module>
<script>
  /**
   * `fs-signin` creates a button that initiates the signin process.
   */
  Polymer({
    
    is: 'fs-signin',
    
    behaviors: [FSBehavior],
    
    properties: {
      
      signedIn: {
        type: Boolean,
        notify: true,
        value: false
      }
      
    },
    
    /**
     * Check authenticated state of client and update display accordingly
     */
    ready: function(){
      this.signedIn = this.isAuthenticated();
    },
    
    _signIn: function(){
      this.$.client.signIn();
    },
    
    _signOut: function(){
      this.$.client.signOut();
    },
    
    _authenticatedChanged: function(e){
      this.signedIn = e.detail.value;
    },
    
    _isAuthenticated: function(signedIn){
      return signedIn;
    },
    
    _isUnauthenticated: function(signedIn){
      return !signedIn;
    }
    
  });
</script>