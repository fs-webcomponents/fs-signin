<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../fs-client/fs-client.html">
<link rel="import" href="../fs-behavior/fs-behavior.html">

<!--
A FamilySearch sign in button.

Example:

    <fs-signin></fs-signin>

@group FamilySearch Elements
@element fs-signin
@demo demo/index.html
-->
<dom-module id="fs-signin">
  <link rel="import" type="css" href="fs-signin.css">
  <template>
    <fs-client id="client" name="{{clientName}}" on-authenticated-changed="_authenticatedChanged"></fs-client>
    <button id="button" class="fs-button fs-button--recommended" on-click="_clickAction">Sign In</button>
  </template>
</dom-module>
<script>

  Polymer({
    
    is: 'fs-signin',
    
    behaviors: [FSBehavior],
    
    properties: {
      
      signedIn: {
        type: Boolean,
        notify: true,
        value: false
      }
      
    },
    
    /**
     * Check authenticated state of client and update display accordingly
     */
    ready: function(){
      this.signedIn = this.isAuthenticated();
    },
    
    _clickAction: function(){
      if(this.signedIn){
        this.$.client.signOut();
      } else {
        this.$.client.signIn();
      }
    },
    
    _authenticatedChanged: function(e){
      this.signedIn = e.detail.value;
      if(this.signedIn){
        this.$.button.textContent = 'Sign Out';
      } else {
        this.$.button.textContent = 'Sign In';
      }
    }
    
  });
</script>